---
description:
globs:
alwaysApply: false
---
# AI聊天系统开发指南

## 聊天系统架构

### 核心组件
- [student-chat.html](mdc:student-chat.html) - 主聊天界面
- 支持两种AI助教模式：预习助教和实验助教
- 实时消息渲染和打字动画效果

### 聊天模式

#### 预习模式 (preview)
- 目标：引导学生了解实验原理和操作要点
- 特点：主动引导，启发式对话
- UI：隐藏模式切换按钮和侧边栏
- 欢迎消息：引导学生进入预习环节

#### 问答模式 (qa)
- 目标：解答实验过程中的具体问题
- 子模式：
  - 引导模式 (guide)：启发式问答
  - 问答模式 (qa)：直接问答
- UI：显示模式切换按钮和常用问题侧边栏

### 数据流程

#### 页面初始化
1. 从localStorage读取课程信息 (`currentCourse`)
2. 从localStorage读取实验名称 (`currentExperiment`)
3. 从localStorage读取聊天模式 (`chatMode`)
4. 更新页面标题和模式指示器

#### 消息处理
1. 用户输入消息
2. 添加用户消息到聊天区域
3. 显示AI打字动画
4. 模拟AI回复（当前为演示，实际需要接入AI API）
5. 显示满意度评价按钮

### UI组件规范

#### 消息气泡
- 用户消息：右对齐，蓝色背景
- AI消息：左对齐，灰色背景，带AI头像
- 消息渐入动画：`message-fade-in`

#### 打字动画
- 三个跳动的圆点
- 颜色：`#3b82f6`
- 动画延迟：0s, 0.2s, 0.4s

#### 满意度评价
- 每次AI回复后显示
- 满意/不满意按钮
- 数据记录到qa_records.csv

### 常用问题侧边栏
- 仅在问答模式下显示
- 根据当前课程ID显示相关问题
- 点击问题自动填入输入框

### 开发注意事项
- 所有用户交互都要有即时反馈
- 消息滚动到底部保持最新消息可见
- 支持Enter键发送消息
- 移动端适配：侧边栏在小屏幕下隐藏
